!function(){"use strict";function r(){function r(){return o}function n(r){o=!0,i=r||i}function e(){return i}var t=this,o=!1,i="fmloader";t.$get=function(){return t},t.isActive=r,t.setCustomActivation=n,t.getQueryParamActivation=e}function n(r){function n(n){n=void 0!==typeof n?"_"+n:"",r.$broadcast("loader_show"+n)}function e(n){n=void 0!==typeof n?"_"+n:"",r.$broadcast("loader_hide"+n)}var t={show:n,hide:e};return t}function e(r,n,e){function t(n){if(!d)return f(n);var e=n.url.substring(n.url.indexOf("?"),n.url.length);return e.indexOf(s)>-1?f(n,u(e)):n||r.when(n)}function o(n){if(!d)return c(n);var e=n.config.url.substring(n.config.url.indexOf("?"),n.config.url.length);return e.indexOf(s)>-1?c(n,u(e)):n||r.when(n)}function i(n){if(!d)return a(n);var e=n.config.url.substring(n.config.url.indexOf("?"),n.config.url.length);return e.indexOf(s)>-1?a(n,u(e)):r.reject(n)}function u(r){var n=r.substring(r.indexOf(s)+s.length,r.length);return n.indexOf("&")>-1&&(n=n.substring(0,n.indexOf("&"))),n="true"===n?"":"_"+n}function f(e,t){return t=t||"",n.$broadcast("loader_show"+t),e||r.when(e)}function c(e,t){return t=t||"",n.$broadcast("loader_hide"+t),e||r.when(e)}function a(e,t){return t=t||"",n.$broadcast("loader_hide"+t),r.reject(e)}var d=e.isActive(),s=e.getQueryParamActivation()+"=",l={request:t,response:o,responseError:i};return l}function t(){var r={restrict:"A",scope:{fmLoader:"@"},link:function(r,n,e){var t=r.fmLoader;t=t.length>0?"_"+t:"";var o=0;$(n).hide(),r.$on("loader_show"+t,function(r){return o++,$(n).show()}),r.$on("loader_hide"+t,function(r){return 0===--o?$(n).hide():void 0})}};return r}var o=angular.module("fm.loader",[]);o.provider("fmLoaderConfig",r),o.factory("fmLoaderFactory",n),n.$inject=["$rootScope"],o.factory("fmLoaderInterceptor",e),e.$inject=["$q","$rootScope","fmLoaderConfig"],o.directive("fmLoader",t)}();