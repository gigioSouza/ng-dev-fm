!function(){"use strict";function n(){function n(){return o}function r(n){if(o=!0,"undefined"!=typeof n){if("string"!=typeof n)throw Error("Invalid custom activation");i=n||i}}function e(){return i}var t=this,o=!1,i="fmloader";t.$get=function(){return t},t.isActive=n,t.setCustomActivation=r,t.getQueryParamActivation=e}function r(n,r){function e(e){e="undefined"!=typeof e?"_"+e:"",r(function(){n.$broadcast("loader_show"+e)},0)}function t(e){e="undefined"!=typeof e?"_"+e:"",r(function(){n.$broadcast("loader_hide"+e)},0)}var o={show:e,hide:t};return o}function e(n,r,e){function t(r){if(!d)return f(r);var e=r.url.substring(r.url.indexOf("?"),r.url.length);return e.indexOf(s)>-1?f(r,u(e)):r||n.when(r)}function o(r){if(!d)return c(r);var e=r.config.url.substring(r.config.url.indexOf("?"),r.config.url.length);return e.indexOf(s)>-1?c(r,u(e)):r||n.when(r)}function i(r){if(!d)return a(r);var e=r.config.url.substring(r.config.url.indexOf("?"),r.config.url.length);return e.indexOf(s)>-1?a(r,u(e)):n.reject(r)}function u(n){var r=n.substring(n.indexOf(s)+s.length,n.length);return r.indexOf("&")>-1&&(r=r.substring(0,r.indexOf("&"))),r="true"===r?"":"_"+r}function f(e,t){return t=t||"",r.$broadcast("loader_show"+t),e||n.when(e)}function c(e,t){return t=t||"",r.$broadcast("loader_hide"+t),e||n.when(e)}function a(e,t){return t=t||"",r.$broadcast("loader_hide"+t),n.reject(e)}var d=e.isActive(),s=e.getQueryParamActivation()+"=",l={request:t,response:o,responseError:i};return l}function t(){var n={restrict:"A",scope:{fmLoader:"@"},link:function(n,r,e){var t=n.fmLoader;t=t.length>0?"_"+t:"";var o=0;$(r).hide(),n.$on("loader_show"+t,function(n){return o++,$(r).show()}),n.$on("loader_hide"+t,function(n){return 0===--o?$(r).hide():void 0})}};return n}var o=angular.module("fm.loader",[]);o.provider("fmLoaderConfig",n),o.factory("fmLoaderFactory",r),r.$inject=["$rootScope","$timeout"],o.factory("fmLoaderInterceptor",e),e.$inject=["$q","$rootScope","fmLoaderConfig"],o.directive("fmLoader",t)}();